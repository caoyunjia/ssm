<!DOCTYPE html>
<html>
<head lang="zh-CN">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>及时雨-忘记密码</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/animate.css">
    <link href="css/main.css?v=APP_VER" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="fonts/iconfont.css">
    <link href="css/sticky-footer-navbar.css" rel="stylesheet">
    <link href="css/new.css?v=APP_VER" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE6 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="js/html5shiv.min.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->
  	<script src="js/union-security-api.v2.2.min.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/plugin/jquery.validate.js"></script>
    <script src="js/plugin/validate-extend.js"></script>
    <script src="js/common.js?v=APP_VER"></script>
    <style>
        input.error,input.error:focus {
            outline: none;
            border: 1px solid red;
        }
        label.error {
            color: red;
            line-height: 30px;
        }
        label {
            line-height: 40px;
        }

    </style>
</head>
<body>
<nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <img class="logo" src="images/LOGO.png" height="">
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="index.html?v=APP_VER">首页</a></li>
                <li><a href="rzlc.html?v=APP_VER">融资流程</a></li>
                <li><a href="sxlc.html?v=APP_VER">授信流程</a></li>
                <li><a href="cjwt.html?v=APP_VER">常见问题</a></li>
                <li class="user-center"><a href="myCenter.html?v=APP_VER">个人中心</a></li>
                <li style="margin-top: 8px; text-align: center; width: 60px"><span><a href="notice.html?v=APP_VER"><img src="images/notice.jpg"></a></span></li>
                <!--<li class="dropdown">-->
                <!--<a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <span class="caret"></span></a>-->
                <!--<ul class="dropdown-menu" role="menu">-->
                <!--<li><a href="#">Action</a></li>-->
                <!--<li><a href="#">Another action</a></li>-->
                <!--<li><a href="#">Something else here</a></li>-->
                <!--<li class="divider"></li>-->
                <!--<li class="dropdown-header">Nav header</li>-->
                <!--<li><a href="#">Separated link</a></li>-->
                <!--<li><a href="#">One more separated link</a></li>-->
                <!--</ul>-->
                <!--</li>-->
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>
<div class="body" style="padding-bottom: 1px">
<div class="container m-content">
    <div id="hyzhuc_out">
        <form name="registForm" id="registForm" action="" method="post">
            <h3 style="text-align: center; margin-bottom: 40px">忘记密码</h3>
            <div style="">
                <div class="row" style="margin-bottom: 20px">
                <div class="col-xs-6 col-xs-offset-3">
                            <label class="control-label col-md-4" for="mobile">手机号</label>
                            <div class="col-md-4">
                                <input type="text" class="col-xs-12 form-control" maxlength="11" name="mobile"
                                       id="mobile"
                                       value="" placeholder="请输入手机号"
                                       onkeydown='if (event.keyCode==13)document.getElementById("picVC").focus();'/>
                            </div>
                            <div class="col-md-2" style="padding:0px">
                                <input type="text" class="col-xs-12 form-control" maxlength="4" name="picVC" id="picVC"
                                       value="" placeholder="验证码"
                                       onkeydown='if (event.keyCode==13)document.getElementById("verifyCode").focus();'/>
                            </div>
                            <div class="col-md-2" style="padding-left: 0;padding-right: 0">
                                <img id="vcodeImg" style="height: 34px; width: 80px;" src="img/checkNum.png" alt=""/>
                            </div>
                        </div>
                    <!-- <div class="col-xs-6 col-xs-offset-3">
                        <label class="col-xs-4" for="mobile">预留手机号</label>
                        <div class="col-xs-4">
                            <input type="text" class="col-xs-12 form-control" maxlength="11" name="mobile" id="mobile"
                                   value="" placeholder="请输入手机号"
                                   onkeydown='if (event.keyCode==13)document.getElementById("picVC").focus();'/>
                        </div>
                         <div class="col-md-2" style="padding:0px">
                        	 <input type="text" class="col-xs-12 form-control" maxlength="4" name="picVC" id="picVC"
                                   value="" placeholder="验证码"
                                   onkeydown='if (event.keyCode==13)document.getElementById("verifyCode").focus();'/>
                        </div>
                        <div class="col-md-2">
                        	<img id="vcodeImg" style="height: 30px; width: 100px;" src="img/checkNum.png" alt=""/>
                        </div>
                    </div> -->
                    <div class="col-xs-3"></div>
                </div>
                <div class="row" style="margin-bottom: 20px">
                    <div class="col-xs-6 col-xs-offset-3">
                        <label class="col-xs-4" for="verifyCode">短信验证码</label>
                        <div class="col-xs-8">
                            <input type="text" class="col-45 form-control" id="verifyCode" name="verifyCode"
                                   maxlength="6"/>
                            <a class="btn btn-primary col-45" href="javascript:void(0)" id="sendValidCode"
                               onclick="sendSmsForResetPwd()" ;>获取验证码</a>
                        </div>
                    </div>
                    <div class="col-xs-3"></div>
                </div>
                <div class="row" style="margin-bottom: 20px">
                    <div class="col-xs-6 col-xs-offset-3">
                        <label class="col-xs-4 control-label" for="password">新密码</label>
                        <div class="col-xs-8">
                            <input class="col-xs-12 form-control" type="password" name="password" id="password"
                                   maxlength="16"/>
                        </div>
                    </div>
                    <div class="col-xs-3"></div>
                </div>
                <div class="row" style="margin-bottom: 20px">
                    <div class="col-xs-6 col-xs-offset-3">
                        <label class="col-xs-4" for="affirmPwd">密码确认</label>
                        <div class="col-xs-8">
                            <input class="col-xs-12 form-control" type="password" name="affirmPwd" id="affirmPwd"
                                   maxlength="16"/>
                        </div>
                    </div>
                    <div class="col-xs-3"></div>
                </div>
            </div>
            <div class="row">
            <div class="col-xs-12 text-center" style="margin-top: 20px; margin-bottom: 100px">
                <button type="submit" class="btn_query btn btn-primary step_over_btn">确认</button>
            </div>
            </div>
        </form>
    </div>
</div>
<div class="footer">
    <div class="container">
        <div class="col-sm-8">
            <img class="logo_wt" src="images/LOGO_white.png">
            <i class="iconfont icon-htmal5icon31">95561</i>
        </div>
        <div class="col-sm-4" style="margin-top: 10px; margin-bottom: 10px">
            <i class="iconfont icon-vip">4008895561</i><br/>
            <i class="iconfont icon-dizhi">上海市浦东新区杨高南路729号41层</i>
        </div>
    </div>
</div>
</div>

<script>

    //发送短信验证码
    function sendSmsForResetPwd() {
        var $this = $(this);
        if ($this.data("disable")) {
            return;
        }
        var mobile = $("#mobile").val();
        if (!mobile) {
        	pluginObj.alert("","请输入手机号！")
        }
        if (!mobile || mobile.length < 11) {
            return;
        }
        var picVC = $("#picVC").val();
        if (!picVC) {
        	pluginObj.alert("","请输入图片验证码！")
        	return "";
        }
        var time = 30;
        var origtext = $("#sendValidCode").text();
        //发送等待
        requestObj.ajaxServer(requestObj.address.sendSmsForResetPwd, {dlzh: mobile,picVC:picVC}, function () {
            $("#sendValidCode").text("发送成功(" + time + "秒)");
            $("#sendValidCode").attr("disabled", true);
            var t = setInterval(function () {
                $("#sendValidCode").text("发送成功(" + (--time) + "秒)");
            }, 1000);
            setTimeout(function () {
                clearInterval(t);
                $("#sendValidCode").text(origtext);
                $("#sendValidCode").attr("disabled", false);
            }, time * 1000);
        }, function(){
        	$("#vcodeImg").trigger("click");
        });
    }

    $(document).ready(function () {
    	$("#vcodeImg").click(function () {
            getVertifyCode($(this));
        }).trigger("click");
    	
        var successFun = function (data, postData) {
        	pluginObj.alert("",data.head._rm);
        	window.setTimeout(function(){window.location.href="index.html?v=APP_VER"},3000);

            //alert(JSON.stringify(data));
        }
        var errorFun = function (data, postData) {
        	//pluginObj.alert(data.head._rm);
        }

        function submitResetPwd() {
            var postData = {
                "dlzh": $("#mobile").val(),
                "mm": pwdEncrypt($("#password").val()),
                "yzm": $("#verifyCode").val()
            }
            requestObj.ajaxServer(requestObj.address.resetPwdWithoutRealName, postData, successFun, errorFun);
        }

        //表单校验
        $("#registForm").validate({
            submitHandler: function (form) {
                //判断是否有勾选用户注册协议
                submitResetPwd();
            },
            onkeyup: false,
            rules: {
                mobile: {
                    required: true,
                    isMobile: true
                },
                picVC: {
                    required: true
                },
                verifyCode: {
                    required: true,
                    minlength: 6
                },
                password: {
                    required: true,
                    minlength: 6
                },
                affirmPwd:{
                	 required: true,
                     minlength: 6,
            	 	 equalTo:"#password"
            }
            },
            messages: {
                mobile: {
                    required: "请输入联系人手机",
                    mobile: true
                },
                picVC: {
                    required: ""
                },
                verifyCode: {
                    required: "请输入验证码",
                    minlength: "验证码长度是6位"
                },
                password: {
                    required: "请输入密码",
                    minlength: "密码最少为6位"
                },
                affirmPwd:{
                	 required: "请输入确认密码",
                	 minlength: "密码最少为6位",
                	 equalTo:"新旧密码不一致"
                }
            }
            , errorPlacement: function (error, element) { //错误信息位置设置方法
                error.appendTo(element.parent().parent().next()); //这里的element是录入数据的对象
            }
        });

    })


</script>


</body>
</html>